<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
    <div id="app" class="container">
        <div class="bg-info p-5 rounded m-5">
            <div class="h2 text-center">MovieOpedia</div>
            <hr />
            <div class="input-group mb-3">
                <span class="input-group-text">Title</span>
                <input type="text" class="form-control" v-model="newMovie.title">
            </div>
            <div class="input-group mb-3">
                <span class="input-group-text">Year</span>
                <input type="text" class="form-control" v-model="newMovie.year">
            </div>
            <div class="text-center pb-3">
                <button class="btn btn-secondary m-2 w-25" v-on:click="addMovie">Add Movie</button>
                <button class="btn btn-danger m-2 w-25" v-on:click="removeMovie">Remove Last Movie</button>
            </div>
            <div class="border p-3 w-100 mx-auto">
                <div class="text-center">
                    <h4 class="text-center">Movie List</h4>
                    <span class="text-danger" v-if="showMessage">You can only add 5 movies!</span>
                    <hr />
                    <ul class="list-group">
                        <li v-for="movie in getMovieText" class="list-group-item">
                        {{movie}}
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <script>
        const {createApp, reactive, ref, computed, watch} = Vue;
        createApp({
            setup() {
                let movies = reactive([
                    {title: "John Wick", year: 2014},
                    {title: "John Wick 2", year: 2017},
                    {title: "John Wick 3", year: 2019}
                ]);
                let newMovie = reactive({title: "", year: ""});
                let showMessage = ref(false);

                watch(movies, () => {
                    if(movies.length >= 3) {
                        showMessage.value = true;
                    } else {
                        showMessage.value = false;
                    }
                });

                function addMovie() {
                    if(newMovie.title === "" || newMovie.year === "") {
                        alert("Movie Information Not Complete!");
                        return;
                    }
                    if(movies.length < 5) {
                        movies.push({...newMovie});
                        newMovie.title = "";
                        newMovie.year = "";
                    }
                }

                function removeMovie() {
                    movies.pop();
                }

                const getMovieText = computed(() => {
                    return movies.map(movie => `${movie.title} was released in the year ${movie.year}.`);
                });

                return {
                    movies, newMovie, addMovie, removeMovie, getMovieText, showMessage
                }
            }
        }).mount("#app");
    </script>
</body>
</html>